{{ define "main" }}
{{- $vinyl := partial "vinyl-parse.html" . -}}

<article class="vinyl-single">
  <header class="vinyl-header">
    {{ with $vinyl.cover }}
    <div class="vinyl-cover-large">
      <img src="{{ . }}" alt="{{ $vinyl.album }} cover">
    </div>
    {{ end }}
    
    <div class="vinyl-details">
      <h1 class="vinyl-album">{{ $vinyl.album }}</h1>
      {{ with $vinyl.artist }}
      <p class="vinyl-artist">{{ . }}</p>
      {{ end }}
      
      <dl class="vinyl-meta">
        {{ with $vinyl.year }}
        <dt>Year</dt>
        <dd>{{ . }}</dd>
        {{ end }}
        
        {{ with $vinyl.format }}
        <dt>Format</dt>
        <dd>{{ . }}</dd>
        {{ end }}
        
        {{ with $vinyl.label }}
        <dt>Label</dt>
        <dd>{{ . }}</dd>
        {{ end }}
        
        {{ with $vinyl.genres }}
        <dt>Genres</dt>
        <dd>{{ delimit . ", " }}</dd>
        {{ end }}
      </dl>
    </div>
  </header>

  {{ with $vinyl.description }}
  <section class="vinyl-description">
    <h2>Notes</h2>
    <div class="vinyl-description-content">{{ . | markdownify }}</div>
  </section>
  {{ end }}

  {{- /* Show any photos beyond the first (cover) as a gallery */ -}}
  {{ with .Params.photos }}
  {{ if gt (len .) 1 }}
  <section class="vinyl-pictures">
    <h2>Additional Pictures</h2>
    <div class="vinyl-gallery">
      {{ range after 1 . }}
        <a href="{{ . }}" class="vinyl-gallery-item">
          <img src="{{ . }}" alt="Album picture" loading="lazy">
        </a>
      {{ end }}
    </div>
  </section>
  {{ end }}
  {{ end }}

  <footer class="vinyl-footer">
    <p class="vinyl-date">Added {{ $vinyl.date | time.Format "January 2, 2006" }}</p>
    <a href="{{ "/categories/vinyl/" | relURL }}">&larr; Back to Collection</a>
  </footer>
</article>
{{ end }}
