{{- /*
  Vinyl Collection Shortcode
  
  Usage:
    vinyl                - Display all vinyl posts as a grid
    vinyl limit="6"      - Display limited number of records
*/ -}}

{{- $limit := .Get "limit" | default 0 -}}
{{- $category := $.Site.Params.vinyl_category | default "Vinyl" -}}

{{- /* Find all posts in the Vinyl category */ -}}
{{- $vinylPosts := slice -}}
{{- range $.Site.Pages -}}
  {{- if in .Params.categories $category -}}
    {{- $vinylPosts = $vinylPosts | append . -}}
  {{- end -}}
{{- end -}}

{{- /* Apply limit if specified */ -}}
{{- if and (gt $limit 0) (gt (len $vinylPosts) $limit) -}}
  {{- $vinylPosts = first $limit $vinylPosts -}}
{{- end -}}

<div class="vinyl-collection vinyl-embed">
  {{- if gt (len $vinylPosts) 0 -}}
  <div class="vinyl-grid">
    {{- range $vinylPosts -}}
      {{- partial "vinyl-card.html" . -}}
    {{- end -}}
  </div>
  {{- else -}}
  <p class="vinyl-empty">No records in your collection yet.</p>
  {{- end -}}
</div>
